{
  "openapi": "3.1.0",
  "info": {
    "title": "Astro Shiva API",
    "version": "2.2.0",
    "description": "Production API contract for Astro Shiva backend (Next.js 16 + AI SDK 6 + Convex + Clerk)."
  },
  "servers": [
    {
      "url": "https://astro-shiva-app.vercel.app",
      "description": "Production"
    },
    {
      "url": "http://127.0.0.1:3000",
      "description": "Local"
    }
  ],
  "tags": [
    { "name": "Health" },
    { "name": "Users" },
    { "name": "Chat" },
    { "name": "Jobs" },
    { "name": "Docs" }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "Meta": {
        "type": "object",
        "properties": {
          "timestamp": { "type": "string", "format": "date-time" },
          "requestId": { "type": "string" },
          "responseTime": { "type": "number" },
          "duration": { "type": "number" }
        },
        "additionalProperties": true
      },
      "ErrorObject": {
        "type": "object",
        "required": ["code", "message"],
        "properties": {
          "code": { "type": "string" },
          "message": { "type": "string" },
          "details": {}
        },
        "additionalProperties": true
      },
      "ErrorResponse": {
        "type": "object",
        "required": ["success", "error"],
        "properties": {
          "success": { "type": "boolean", "const": false },
          "error": { "$ref": "#/components/schemas/ErrorObject" },
          "meta": { "$ref": "#/components/schemas/Meta" }
        },
        "additionalProperties": true
      },
      "HealthResponse": {
        "type": "object",
        "required": ["success", "status", "timestamp", "dependencies"],
        "properties": {
          "success": { "type": "boolean" },
          "status": { "type": "string", "enum": ["healthy", "degraded"] },
          "timestamp": { "type": "string", "format": "date-time" },
          "serverStartTime": { "type": "string", "format": "date-time" },
          "environment": { "type": "string" },
          "dependencies": {
            "type": "object",
            "properties": {
              "convex": {
                "type": "object",
                "properties": {
                  "status": { "type": "string", "enum": ["healthy", "unhealthy"] },
                  "latency": { "type": "number" },
                  "error": { "type": "string" }
                },
                "additionalProperties": true
              }
            },
            "additionalProperties": true
          },
          "meta": { "$ref": "#/components/schemas/Meta" }
        },
        "additionalProperties": true
      },
      "OnboardingRequest": {
        "type": "object",
        "required": ["name", "dateOfBirth", "timeOfBirth", "place"],
        "properties": {
          "name": { "type": "string", "minLength": 2, "maxLength": 100 },
          "dateOfBirth": { "type": "string", "format": "date-time" },
          "timeOfBirth": { "type": "string", "pattern": "^\\d{2}:\\d{2}$" },
          "place": { "type": "string", "minLength": 2 },
          "latitude": { "type": "number", "minimum": -90, "maximum": 90 },
          "longitude": { "type": "number", "minimum": -180, "maximum": 180 },
          "timezone": { "type": "string" }
        },
        "additionalProperties": true
      },
      "OnboardingResponse": {
        "type": "object",
        "required": ["success", "data"],
        "properties": {
          "success": { "type": "boolean", "const": true },
          "message": { "type": "string" },
          "data": {
            "type": "object",
            "required": ["uid", "status"],
            "properties": {
              "uid": { "type": "string" },
              "status": { "type": "string" },
              "astroData": {
                "type": "object",
                "properties": {
                  "summary": { "type": "string" },
                  "ascendant": { "type": ["string", "null"] },
                  "moonSign": { "type": ["string", "null"] }
                },
                "additionalProperties": true
              }
            },
            "additionalProperties": true
          },
          "meta": { "$ref": "#/components/schemas/Meta" }
        },
        "additionalProperties": true
      },
      "UpdateProfileRequest": {
        "type": "object",
        "properties": {
          "name": { "type": "string", "minLength": 2, "maxLength": 100 },
          "email": { "type": "string", "format": "email" }
        },
        "additionalProperties": false
      },
      "ProfileResponse": {
        "type": "object",
        "required": ["success", "data"],
        "properties": {
          "success": { "type": "boolean", "const": true },
          "data": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "name": { "type": "string" },
              "email": { "type": "string" },
              "status": { "type": "string" },
              "failureReason": { "type": "string" },
              "astroData": {
                "type": ["object", "null"],
                "additionalProperties": true
              },
              "createdAt": { "type": "string", "format": "date-time" }
            },
            "additionalProperties": true
          },
          "meta": { "$ref": "#/components/schemas/Meta" }
        },
        "additionalProperties": true
      },
      "ChatSession": {
        "type": "object",
        "required": ["id", "title", "createdAt", "lastMessageAt", "messageCount", "status"],
        "properties": {
          "id": { "type": "string" },
          "title": { "type": "string" },
          "createdAt": { "type": "string", "format": "date-time" },
          "lastMessageAt": { "type": "string", "format": "date-time" },
          "messageCount": { "type": "integer" },
          "status": { "type": "string" },
          "metadata": {
            "type": "object",
            "additionalProperties": true
          }
        },
        "additionalProperties": true
      },
      "ChatStreamRequestMessage": {
        "type": "object",
        "required": ["message"],
        "properties": {
          "sessionId": { "type": "string", "minLength": 1, "maxLength": 128 },
          "message": { "type": "string", "minLength": 1, "maxLength": 5000 },
          "model": { "type": "string", "minLength": 1, "maxLength": 120 }
        },
        "additionalProperties": true
      },
      "ChatStreamRequestMessages": {
        "type": "object",
        "required": ["messages"],
        "properties": {
          "sessionId": { "type": "string", "minLength": 1, "maxLength": 128 },
          "messages": {
            "type": "array",
            "minItems": 1,
            "maxItems": 200,
            "items": {
              "type": "object",
              "additionalProperties": true
            }
          },
          "model": { "type": "string", "minLength": 1, "maxLength": 120 }
        },
        "additionalProperties": true
      },
      "JobSummary": {
        "type": "object",
        "properties": {
          "jobId": { "type": "string" },
          "type": { "type": "string" },
          "status": { "type": "string" },
          "priority": { "type": "string" },
          "progress": { "type": "number" },
          "createdAt": { "type": "number" },
          "updatedAt": { "type": "number" },
          "expiresAt": { "type": "number" }
        },
        "additionalProperties": true
      }
    }
  },
  "paths": {
    "/api/v1/health": {
      "get": {
        "tags": ["Health"],
        "operationId": "getHealth",
        "summary": "Service health check",
        "responses": {
          "200": {
            "description": "Healthy",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HealthResponse" }
              }
            }
          },
          "503": {
            "description": "Degraded",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HealthResponse" }
              }
            }
          }
        }
      },
      "options": {
        "tags": ["Health"],
        "operationId": "optionsHealth",
        "summary": "CORS preflight",
        "responses": { "204": { "description": "No content" } }
      }
    },
    "/api/v1/metrics": {
      "get": {
        "tags": ["Health"],
        "operationId": "getMetrics",
        "summary": "Prometheus metrics",
        "responses": {
          "200": {
            "description": "Metrics",
            "content": {
              "text/plain": {
                "schema": { "type": "string" }
              }
            }
          },
          "500": {
            "description": "Metrics collector error"
          }
        }
      },
      "options": {
        "tags": ["Health"],
        "operationId": "optionsMetrics",
        "summary": "CORS preflight",
        "responses": { "204": { "description": "No content" } }
      }
    },
    "/api/v1/users/onboard": {
      "post": {
        "tags": ["Users"],
        "operationId": "postUsersOnboard",
        "summary": "Onboard user and persist astrology data",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/OnboardingRequest" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Onboarding complete",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/OnboardingResponse" }
              }
            }
          },
          "400": { "description": "Validation error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "401": { "description": "Unauthorized", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "502": { "description": "Upstream astrology API failed", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "504": { "description": "Upstream timeout/cold start", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "500": { "description": "Internal error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } }
        }
      },
      "options": {
        "tags": ["Users"],
        "operationId": "optionsUsersOnboard",
        "summary": "CORS preflight",
        "responses": { "204": { "description": "No content" } }
      }
    },
    "/api/v1/users/profile": {
      "get": {
        "tags": ["Users"],
        "operationId": "getUsersProfile",
        "summary": "Get authenticated user profile",
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Profile payload",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ProfileResponse" }
              }
            }
          },
          "401": { "description": "Unauthorized", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "500": { "description": "Internal error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } }
        }
      },
      "put": {
        "tags": ["Users"],
        "operationId": "putUsersProfile",
        "summary": "Update authenticated profile",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/UpdateProfileRequest" }
            }
          }
        },
        "responses": {
          "200": { "description": "Updated" },
          "400": { "description": "Validation error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "401": { "description": "Unauthorized", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "404": { "description": "User not found", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "500": { "description": "Internal error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } }
        }
      },
      "options": {
        "tags": ["Users"],
        "operationId": "optionsUsersProfile",
        "summary": "CORS preflight",
        "responses": { "204": { "description": "No content" } }
      }
    },
    "/api/v1/chat/stream": {
      "post": {
        "tags": ["Chat"],
        "operationId": "postChatStream",
        "summary": "Primary SSE chat endpoint",
        "description": "Accepts either `message` or `messages[]`. Returns AI SDK UI-message SSE stream. `X-Session-ID` is canonical.",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "oneOf": [
                  { "$ref": "#/components/schemas/ChatStreamRequestMessage" },
                  { "$ref": "#/components/schemas/ChatStreamRequestMessages" }
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "SSE stream",
            "headers": {
              "X-Session-ID": { "schema": { "type": "string" } },
              "X-Request-ID": { "schema": { "type": "string" } },
              "X-RateLimit-Limit": { "schema": { "type": "string" } },
              "X-RateLimit-Remaining": { "schema": { "type": "string" } },
              "X-RateLimit-Reset": { "schema": { "type": "string", "format": "date-time" } }
            },
            "content": {
              "text/event-stream": {
                "schema": { "type": "string" },
                "example": "data: {\"type\":\"start\",\"messageMetadata\":{\"requestId\":\"req_...\",\"sessionId\":\"ks...\"},\"messageId\":\"msg-...\"}"
              }
            }
          },
          "400": { "description": "Validation error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "401": { "description": "Unauthorized", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "403": { "description": "Forbidden (session ownership)", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "404": { "description": "User/session not found", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "409": { "description": "User onboarding not completed", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "413": { "description": "Payload too large", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "415": { "description": "Unsupported content type", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "429": { "description": "Rate limited", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "500": { "description": "Internal error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } }
        }
      },
      "options": {
        "tags": ["Chat"],
        "operationId": "optionsChatStream",
        "summary": "CORS preflight",
        "responses": { "204": { "description": "No content" } }
      }
    },
    "/api/v1/chat/send": {
      "post": {
        "tags": ["Chat"],
        "operationId": "postChatSendDeprecated",
        "summary": "Deprecated endpoint",
        "responses": {
          "410": {
            "description": "Deprecated. Use /api/v1/chat/stream",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ErrorResponse" }
              }
            }
          }
        }
      },
      "options": {
        "tags": ["Chat"],
        "operationId": "optionsChatSend",
        "summary": "CORS preflight",
        "responses": { "204": { "description": "No content" } }
      }
    },
    "/api/v1/chat/sessions": {
      "get": {
        "tags": ["Chat"],
        "operationId": "getChatSessions",
        "summary": "List user chat sessions",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 20, "minimum": 1, "maximum": 100 } },
          { "name": "offset", "in": "query", "schema": { "type": "integer", "default": 0, "minimum": 0 } }
        ],
        "responses": {
          "200": {
            "description": "Sessions list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": { "type": "boolean", "const": true },
                    "data": {
                      "type": "object",
                      "properties": {
                        "sessions": { "type": "array", "items": { "$ref": "#/components/schemas/ChatSession" } },
                        "total": { "type": "integer" },
                        "hasMore": { "type": "boolean" }
                      },
                      "additionalProperties": true
                    },
                    "meta": { "$ref": "#/components/schemas/Meta" }
                  },
                  "additionalProperties": true
                }
              }
            }
          },
          "401": { "description": "Unauthorized", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "404": { "description": "User not found", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "429": { "description": "Rate limited", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "500": { "description": "Internal error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } }
        }
      },
      "post": {
        "tags": ["Chat"],
        "operationId": "postChatSession",
        "summary": "Create new chat session",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": { "type": "string" },
                  "metadata": { "type": "object", "additionalProperties": true }
                },
                "additionalProperties": true
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Created",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": { "type": "boolean", "const": true },
                    "data": {
                      "type": "object",
                      "properties": {
                        "session": { "$ref": "#/components/schemas/ChatSession" }
                      },
                      "additionalProperties": true
                    },
                    "meta": { "$ref": "#/components/schemas/Meta" }
                  },
                  "additionalProperties": true
                }
              }
            }
          },
          "400": { "description": "Validation error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "401": { "description": "Unauthorized", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "404": { "description": "User not found", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "429": { "description": "Rate limited", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "500": { "description": "Internal error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } }
        }
      },
      "options": {
        "tags": ["Chat"],
        "operationId": "optionsChatSessions",
        "summary": "CORS preflight",
        "responses": { "204": { "description": "No content" } }
      }
    },
    "/api/v1/chat/sessions/{sessionId}": {
      "delete": {
        "tags": ["Chat"],
        "operationId": "deleteChatSession",
        "summary": "Delete a chat session",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "sessionId", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": {
            "description": "Session deleted",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": { "type": "boolean", "const": true },
                    "message": { "type": "string" },
                    "meta": { "$ref": "#/components/schemas/Meta" }
                  },
                  "additionalProperties": true
                }
              }
            }
          },
          "401": { "description": "Unauthorized", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "403": { "description": "Forbidden (session not owned by user)", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "404": { "description": "Session not found", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "500": { "description": "Internal error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } }
        }
      },
      "options": {
        "tags": ["Chat"],
        "operationId": "optionsChatSession",
        "summary": "CORS preflight",
        "responses": { "204": { "description": "No content" } }
      }
    },
    "/api/v1/chat/sessions/{sessionId}/messages": {
      "get": {
        "tags": ["Chat"],
        "operationId": "getChatSessionMessages",
        "summary": "Get messages for one chat session",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "sessionId", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 50, "minimum": 1, "maximum": 100 } },
          { "name": "offset", "in": "query", "schema": { "type": "integer", "default": 0, "minimum": 0 } }
        ],
        "responses": {
          "200": { "description": "Messages payload" },
          "400": { "description": "Validation error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "401": { "description": "Unauthorized", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "403": { "description": "Forbidden", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "404": { "description": "Not found", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "429": { "description": "Rate limited", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "500": { "description": "Internal error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } }
        }
      },
      "options": {
        "tags": ["Chat"],
        "operationId": "optionsChatSessionMessages",
        "summary": "CORS preflight",
        "responses": { "204": { "description": "No content" } }
      }
    },
    "/api/v1/jobs/status": {
      "get": {
        "tags": ["Jobs"],
        "operationId": "getJobsStatus",
        "summary": "Poll latest job or specific job",
        "description": "At least one query parameter is required: `jobId` or `uid`.",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "jobId", "in": "query", "required": false, "schema": { "type": "string" } },
          { "name": "uid", "in": "query", "required": false, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": {
            "description": "Job status",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": { "type": "boolean", "const": true },
                    "data": { "$ref": "#/components/schemas/JobSummary" },
                    "meta": { "$ref": "#/components/schemas/Meta" }
                  },
                  "additionalProperties": true
                }
              }
            }
          },
          "400": { "description": "Validation error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "401": { "description": "Unauthorized", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "403": { "description": "Forbidden", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "404": { "description": "Job not found", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "429": { "description": "Rate limited", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "500": { "description": "Internal error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } }
        }
      },
      "post": {
        "tags": ["Jobs"],
        "operationId": "postJobsStatus",
        "summary": "Create async job",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["type"],
                "properties": {
                  "type": { "type": "string" },
                  "data": { "type": "object", "additionalProperties": true },
                  "priority": { "type": "string", "enum": ["low", "normal", "high", "critical"] },
                  "expiresInMs": { "type": "number" }
                },
                "additionalProperties": true
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Job created",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": { "type": "boolean", "const": true },
                    "data": {
                      "type": "object",
                      "properties": {
                        "jobId": { "type": "string" },
                        "type": { "type": "string" },
                        "status": { "type": "string" },
                        "priority": { "type": "string" },
                        "progress": { "type": "number" },
                        "createdAt": { "type": "number" },
                        "expiresAt": { "type": "number" }
                      },
                      "additionalProperties": true
                    },
                    "meta": { "$ref": "#/components/schemas/Meta" }
                  },
                  "additionalProperties": true
                }
              }
            }
          },
          "400": { "description": "Validation error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "401": { "description": "Unauthorized", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "429": { "description": "Rate limited", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "500": { "description": "Internal error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } }
        }
      },
      "options": {
        "tags": ["Jobs"],
        "operationId": "optionsJobsStatus",
        "summary": "CORS preflight",
        "responses": { "204": { "description": "No content" } }
      }
    },
    "/api/v1/jobs/{id}": {
      "get": {
        "tags": ["Jobs"],
        "operationId": "getJobById",
        "summary": "Get detailed job",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } },
          { "name": "includeData", "in": "query", "required": false, "schema": { "type": "boolean", "default": false } },
          { "name": "includeResult", "in": "query", "required": false, "schema": { "type": "boolean", "default": true } }
        ],
        "responses": {
          "200": { "description": "Job detail" },
          "400": { "description": "Validation error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "401": { "description": "Unauthorized", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "403": { "description": "Forbidden", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "404": { "description": "Not found", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "429": { "description": "Rate limited", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "500": { "description": "Internal error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } }
        }
      },
      "delete": {
        "tags": ["Jobs"],
        "operationId": "deleteJobById",
        "summary": "Cancel job",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "responses": {
          "200": { "description": "Cancelled" },
          "400": { "description": "Validation error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "401": { "description": "Unauthorized", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "403": { "description": "Forbidden", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "404": { "description": "Not found", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "409": { "description": "Invalid state for cancellation", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "429": { "description": "Rate limited", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } },
          "500": { "description": "Internal error", "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ErrorResponse" } } } }
        }
      },
      "options": {
        "tags": ["Jobs"],
        "operationId": "optionsJobById",
        "summary": "CORS preflight",
        "responses": { "204": { "description": "No content" } }
      }
    },
    "/api/docs": {
      "get": {
        "tags": ["Docs"],
        "operationId": "getDocs",
        "summary": "Machine-readable API docs summary",
        "responses": {
          "200": {
            "description": "Docs payload",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        }
      }
    }
  }
}
